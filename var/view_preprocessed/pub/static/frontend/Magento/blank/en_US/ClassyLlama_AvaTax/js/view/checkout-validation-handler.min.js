define(['jquery','Magento_Checkout/js/model/step-navigator','ClassyLlama_AvaTax/js/action/set-shipping-address','ClassyLlama_AvaTax/js/view/update-address','ClassyLlama_AvaTax/js/model/address-model','ClassyLlama_AvaTax/js/view/address-validation-form'],function($,stepNavigator,setShippingAddress,updateAddress,addressModel,addressValidationForm){'use strict';return{options:{validateAddressContainerSelector:'#validate_address'},validAddressRadioSelector:'.validAddress',addressValidationRadioGroupName:'addressToUse',validationResponseHandler:function(response){addressModel.error(null);if(typeof response.extension_attributes!=='undefined'){$(this.options.validateAddressContainerSelector+' *').fadeIn();this.toggleAddressToUse();if(typeof response.extension_attributes.valid_address!=='undefined'){updateAddress(response.extension_attributes.valid_address,true);addressModel.validAddress(response.extension_attributes.valid_address);}
addressModel.originalAddress(response.extension_attributes.original_address);if(typeof response.extension_attributes.error_message!=='undefined'){addressModel.error(response.extension_attributes.error_message)}
addressValidationForm.fillValidateForm(this.options.validateAddressContainerSelector);if(!addressModel.isDifferent()&&addressModel.error()==null){$(this.options.validateAddressContainerSelector+" *").hide();}
$(this.options.validateAddressContainerSelector+' .instructions .edit-address').on('click',function(){stepNavigator.navigateTo('shipping','shipping');});}else{$(this.options.validateAddressContainerSelector+" *").hide();}},toggleAddressToUse:function(){var self=this;$('input[name='+this.addressValidationRadioGroupName+']:radio').off('change');$('input[name='+this.addressValidationRadioGroupName+']:radio').on('change',function(){var validSelected=$(self.validAddressRadioSelector).is(':checked');setShippingAddress(validSelected);});}};});